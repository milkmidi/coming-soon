"use strict";function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==(void 0===e?"undefined":_typeof(e))&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+(void 0===e?"undefined":_typeof(e)));t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_createClass=function(){function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}}(),Observable=Rx.Observable,DECAY=.9,GRAVITY=1,offsetX=0,Particle=function(t){function s(t,e,i,n){_classCallCheck(this,s);var o=new PIXI.Texture(t,new PIXI.Rectangle(e,i,n,n)),r=_possibleConstructorReturn(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,o));return r.lock=!0,r.vx=0,r.vy=0,r.onFloor=!1,r.offsetX=0,r}return _inherits(s,PIXI.Sprite),_createClass(s,[{key:"setBasePosition",value:function(t,e){this.x=t,this.y=e,this.baseX=t,this.baseY=e}},{key:"smash",value:function(t,e){this.vx=t,this.vy=e,this.lock=!1}},{key:"tick",value:function(){var t=this;if(!this.lock){var e=window,i=e.innerWidth,n=e.innerHeight;this.x+=this.vx,this.y+=this.vy,this.rotation+=this.vx*(Math.PI/180),this.alpha=.75,this.onFloor?(this.vx*=DECAY,Math.abs(this.vx)<.5&&(this.lock=!0,setTimeout(function(){TweenMax.to(t,.3,{x:t.baseX,y:t.baseY,rotation:0,alpha:1,onComplete:function(){t.onFloor=!1}})},1600))):(this.vy+=GRAVITY,Math.abs(this.vy)<.5&&this.y>=n-10&&(this.onFloor=!0,this.vy=0,this.y=n)),this.x<0?this.vx*=-.5:this.x>i&&(this.x=i,this.vx*=-.5),this.y>n&&(this.y=n,this.vy*=-.5)}}}]),s}(),App=function(){function n(t){var e=this;_classCallCheck(this,n),this.onTick=function(){e.objectsArr.forEach(function(t){t.tick()})},this.view=t,this.objectsArr=[];var i=new Image;i.src="./img/coming-soon-512.png",i.onload=function(){e.init(t,i)}}return _createClass(n,[{key:"init",value:function(t,e){var i=this,n=window,o=n.innerWidth,r=n.innerHeight,s=new PIXI.Application(o,r,{antialias:!0,transparent:!1,view:t,forceCanvas:!1,roundPixels:!0});this.app=s,this.app.ticker.add(this.onTick);var a=e.width,c=e.height/4,h=c*(a/4),u=(o-a)/2,l=new PIXI.particles.ParticleContainer(h,{scale:!1,position:!0,rotation:!1,uvs:!1,alpha:!1});this.app.stage.addChild(l);for(var f=PIXI.BaseTexture.from(e),p=0;p<h;p++){var v=4*(p%c),b=4*Math.floor(p/c),y=new Particle(f,v,b,4);y.setBasePosition(v+u,b+10),l.addChild(y),this.objectsArr.push(y)}this.registerEvent(),Observable.fromEvent(window,"resize").debounceTime(150).startWith(window).subscribe(function(){i.app.renderer.resize(window.innerWidth,window.innerHeight),offsetX=(o-a)/2})}},{key:"registerEvent",value:function(){var n=this,t=Observable.fromEvent(this.view,"mousedown"),e=Observable.fromEvent(document,"mousemove"),i=Observable.fromEvent(document,"mouseup"),o=t.flatMap(function(){return e.map(function(t){return t.preventDefault(),{left:t.moveMomentX,top:t.moveMomentY}}).takeUntil(i)});this.mouseDragSubscribe=Observable.merge(t,o).subscribe(function(){var t=n.app.renderer.plugins.interaction.mouse.global,e=t.x,i=t.y;n.smash(e,i)})}},{key:"smash",value:function(t,e){var n=t,o=e;this.objectsArr.forEach(function(t){if(Math.sqrt(Math.pow(t.x-n,2)+Math.pow(t.y-o,2))<40&&t.lock){var e=4*(10*Math.random()-5),i=4*(10*Math.random()-5);t.smash(e,i)}})}},{key:"destroy",value:function(){this.mouseDragSubscribe&&(this.mouseDragSubscribe.unsubscribe(),this.mouseDragSubscribe=null),this.app.ticker.remove(this.onTick),this.app.destroy(),this.app=null}}]),n}(),app=new App(document.getElementById("canvas"));